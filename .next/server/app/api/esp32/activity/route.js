"use strict";(()=>{var e={};e.id=595,e.ids=[595],e.modules={53524:e=>{e.exports=require("@prisma/client")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},12259:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>g,originalPathname:()=>f,patchFetch:()=>h,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>y,staticGenerationAsyncStorage:()=>v,staticGenerationBailout:()=>m});var a={};r.r(a),r.d(a,{GET:()=>p,POST:()=>c});var s=r(95419),i=r(69108),n=r(99678),o=r(78070);let u=new(r(53524)).PrismaClient;async function c(e){try{let{userId:t,steps:r,calories:a,distance:s,duration:i}=await e.json();if(!t||!r||!a)return o.Z.json({error:"Missing required fields: userId, steps, and calories"},{status:400});if(r<0||r>1e5)return o.Z.json({error:"Invalid steps value"},{status:400});if(a<0||a>1e4)return o.Z.json({error:"Invalid calories value"},{status:400});let n=await u.activityData.create({data:{userId:t,steps:r,calories:a,distance:s||null,duration:i||null}});return r>=1e4?await u.notification.create({data:{userId:t,title:"Step Goal Achieved!",message:`Congratulations! You've reached ${r} steps today.`,type:"success"}}):r>=5e3&&await u.notification.create({data:{userId:t,title:"Good Progress",message:`You've taken ${r} steps today. Keep it up!`,type:"info"}}),o.Z.json({success:!0,data:n})}catch(e){return console.error("Error processing activity data:",e),o.Z.json({error:"Internal server error"},{status:500})}}async function p(e){try{let{searchParams:t}=new URL(e.url),r=t.get("userId"),a=parseInt(t.get("limit")||"100");if(!r)return o.Z.json({error:"Missing userId parameter"},{status:400});let s=await u.activityData.findMany({where:{userId:r},orderBy:{timestamp:"desc"},take:a});return o.Z.json({success:!0,data:s})}catch(e){return console.error("Error fetching activity data:",e),o.Z.json({error:"Internal server error"},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/esp32/activity/route",pathname:"/api/esp32/activity",filename:"route",bundlePath:"app/api/esp32/activity/route"},resolvedPagePath:"G:\\programming\\diditopia\\first\\app\\api\\esp32\\activity\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:v,serverHooks:y,headerHooks:g,staticGenerationBailout:m}=d,f="/api/esp32/activity/route";function h(){return(0,n.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:v})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[638,206],()=>r(12259));module.exports=a})();