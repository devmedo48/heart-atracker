"use strict";(()=>{var e={};e.id=809,e.ids=[809],e.modules={53524:e=>{e.exports=require("@prisma/client")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},33061:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>g,originalPathname:()=>v,patchFetch:()=>w,requestAsyncStorage:()=>c,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>f});var a={};t.r(a),t.d(a,{GET:()=>l,POST:()=>p});var s=t(95419),i=t(69108),n=t(99678),o=t(78070);let u=new(t(53524)).PrismaClient;async function p(e){try{let{userId:r,bpm:t,quality:a}=await e.json();if(!r||!t)return o.Z.json({error:"Missing required fields: userId and bpm"},{status:400});if(t<30||t>200)return o.Z.json({error:"Invalid heart rate value"},{status:400});let s=await u.heartRateData.create({data:{userId:r,bpm:t,quality:a||"normal"}});return t>100?await u.notification.create({data:{userId:r,title:"High Heart Rate Alert",message:`Your heart rate is elevated at ${t} BPM. Consider taking a break.`,type:"alert"}}):t<50&&await u.notification.create({data:{userId:r,title:"Low Heart Rate Alert",message:`Your heart rate is low at ${t} BPM. Please consult a healthcare provider if this persists.`,type:"warning"}}),o.Z.json({success:!0,data:s})}catch(e){return console.error("Error processing heart rate data:",e),o.Z.json({error:"Internal server error"},{status:500})}}async function l(e){try{let{searchParams:r}=new URL(e.url),t=r.get("userId"),a=parseInt(r.get("limit")||"100");if(!t)return o.Z.json({error:"Missing userId parameter"},{status:400});let s=await u.heartRateData.findMany({where:{userId:t},orderBy:{timestamp:"desc"},take:a});return o.Z.json({success:!0,data:s})}catch(e){return console.error("Error fetching heart rate data:",e),o.Z.json({error:"Internal server error"},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/esp32/heart-rate/route",pathname:"/api/esp32/heart-rate",filename:"route",bundlePath:"app/api/esp32/heart-rate/route"},resolvedPagePath:"G:\\programming\\diditopia\\first\\app\\api\\esp32\\heart-rate\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:c,staticGenerationAsyncStorage:h,serverHooks:m,headerHooks:g,staticGenerationBailout:f}=d,v="/api/esp32/heart-rate/route";function w(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[638,206],()=>t(33061));module.exports=a})();